## Release Information

- Solution Pack Version: 1.0.0
- Minimum Compatible FortiSOARâ„¢ Version : 7.2.0
- Authored By: Fortinet
- Certified: No

## Overview

### Introduction

**Malware Response Using SIEM & EDR Solutions Pack** demonstrates the scenarios and use cases around Malware reported by ElasticSearch or Splunk.

Configure ingestion using ElasticSearch or Splunk connector. Ingestion process creates an alert of type **Malware**, and then manually triggers the response workflow.

Refer to Simulation Scenarios - "Malware Response Using SIEM and EDR Solutions (ElasticSearch / Active Directory / VMware vSphere)" or "Malware Response Using SIEM and EDR Solutions (Splunk/QRadar/FortiEDR)" to experience the use case without ElasticSearch or Splunk connector configuration.

### Usage

Refer to [Simulate Scenario documentation](https://github.com/fortinet-fortisoar/solution-pack-soc-simulator/blob/develop/docs/solution-pack-guide.md) to understand how to Simulate and Reset scenarios.

This Solution Pack ships with the following simulation scenarios. 

#### 1. Scenario - Malware Response Using SIEM and EDR Solutions (ElasticSearch / Active Directory / VMware vSphere)

The scenario generates a demo alert of Type **Malware**.

Navigate to the generated alert and observe the following:

- Asset details like Device UID, File Hash.
- Details like Process Name, Command Line, Source Process, Source IP, and Destination IP

**Investigate Malware Response (ElasticSearch / Active Directory / VMware vSphere)** : Launch **Investigate Malware Response (ElasticSearch / Active Directory / VMware vSphere)** Playbook and observe various investigation activities such as

- Listing affected Hosts using ElasticSearch
- Viewing active affected Hosts using ElasticSearch
- Searching active affected Hosts using the Active Directory
- Finding malicious indicators associated with the Malware Alert
- Taking a VM Snapshot using VMware vSphere

#### 2. Scenario - Malware Response Using SIEM and EDR Solutions (Splunk/QRadar/FortiEDR)

The scenario generates a demo alert of Type **Malware**.

Navigate to the generated alert and observe the following:

- Asset details like Computer Name, File Name, File Hash, and Source IP

**Investigate Malware Response (Splunk/QRadar/FortiEDR)** : Launch **Investigate Malware Response (Splunk/QRadar/FortiEDR)** Playbook and observe various investigation activities such as

- Finding malicious indicators in the alert and scanning the endpoint
- Investigate endpoint manually, to detemine if this is malicious activity, if no malicious indicators found 
- Hunting the malicious indicators using Splunk, QRadar, and FortiEDR
- Blocking the Malicious Indicators

## Prerequisites

|**Solution Pack Name**|**Purpose**|**Doc Link**|
| :- | :- | :- |
|SOAR Framework 1.0.0|Require for Incident Response modules|[Click here](https://github.com/fortinet-fortisoar/solution-pack-soar-framework/blob/develop/README.md)|
|SOC Simulator 1.0.1|Require for Scenario Module and SOC Simulator connector| [Click here](https://github.com/fortinet-fortisoar/solution-pack-soc-simulator/blob/develop/README.md)|

## Contents

1. Connector(s)
    |**SN**|**Connector Name**|
    | :- | :- |
    |1|Microsoft Active Directory|
    |2|ElasticSearch|
    |3|Fortinet FortiEDR|
    |4|IBM QRadar|
    |5|Splunk|
    |6|VMware vSphere|

     **Warning:** After deployment, this Solution Pack installs or upgrades the stated list of connectors.
2. Global Variable(s)
    - Demo_mode: This Global variable (boolean) is used to simulate the usecase using the Mock Output.
    - QRadarTimeZone: This Globalvaraibale is used to extract the QRadar Time Zone.
3. Record Set(s)
    - Malware Response Using SIEM and EDR Solutions (Splunk/QRadar/FortiEDR) scenario.
    - Malware Response Using SIEM and EDR Solutions (ElasticSearch / Active Directory / VMware vSphere) scenario.
4. Playbook Collection(s)
    - 02 - Use Case - Malware Response Using SIEM and EDR Solutions (5): Following is a list of playbooks under "Use Case - Malware Response Using SIEM and EDR Solutions" solution pack.

    |**Sr.No**|**Playbook Name**|**Description**|
    | :- | :- | :- |
    |1|Investigate Malware Response (Splunk/QRadar/FortiEDR)|Investigates malware alert by checking if any malicious indicator found on the endpoint and then performs hunt for malicious indicator to block the same on firewall. Also performs a full scan of endpoint.|
    |2|Investigate Malicious Indicator - Hunt - Splunk and FortiEDR Threat Hunt|Referenced by 'Investigate Malicious Indicator' playbook to perform a hunt on malicious indicators using QRadar, Splunk, and FortiEDR.|
    |3|Investigate Malicious Indicator - Hunt - QRadar Threat Hunt|Performs QRadar Threat Hunting for the last 7 days on the specified IOC.|
    |4|Investigate Malware Response (ElasticSearch / Active Directory / VMware vSphere)|Investigates a malware infection by querying ElasticSearch and Active Directory.|
    |5|Generate - Malware Alert (Splunk/QRadar/FortiEDR)|Creates a demo Alert and Asset record for demonstration of Malware IR.|

     **Warning:** It is recommended to clone these Playbooks before any customizations to avoid loss of information while upgrading the Solution Pack.
